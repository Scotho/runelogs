(()=>{"use strict";let e=function(e){return e.LOG_VERSION="Log Version",e.LOGGED_IN_PLAYER="Logged In Player",e.BOOSTED_LEVELS="Boosted Levels",e.PLAYER_EQUIPMENT="Player Equipment",e.DEATH="Death",e.TARGET_CHANGE="Target Change",e.DAMAGE="Damage",e}({});let t=function(e){return e[e.BLOCK_ME=12]="BLOCK_ME",e[e.DAMAGE_ME=16]="DAMAGE_ME",e[e.DAMAGE_ME_CYAN=18]="DAMAGE_ME_CYAN",e[e.DAMAGE_ME_ORANGE=20]="DAMAGE_ME_ORANGE",e[e.DAMAGE_ME_YELLOW=22]="DAMAGE_ME_YELLOW",e[e.DAMAGE_ME_WHITE=24]="DAMAGE_ME_WHITE",e[e.SPLASH_ME=69]="SPLASH_ME",e}({}),n=function(e){return e[e.DAMAGE_MAX_ME=43]="DAMAGE_MAX_ME",e[e.DAMAGE_MAX_ME_CYAN=44]="DAMAGE_MAX_ME_CYAN",e[e.DAMAGE_MAX_ME_ORANGE=45]="DAMAGE_MAX_ME_ORANGE",e[e.DAMAGE_MAX_ME_YELLOW=46]="DAMAGE_MAX_ME_YELLOW",e[e.DAMAGE_MAX_ME_WHITE=47]="DAMAGE_MAX_ME_WHITE",e}({});const a=e=>{const[t,n,a]=e.split(":").map(Number);return 36e5*t+6e4*n+1e3*a},o=["Scurrius","Kree'arra","Commander Zilyana","General Graardor","K'ril Tsutsaroth","Nex","Kalphite Queen","Sarachnis","Scorpia","Abyssal Sire"];function r(e){return Object.values(t).includes(e.hitsplatName)||Object.values(n).includes(e.hitsplatName)||"BLOCK_ME"===e.hitsplatName}const s=t=>{const n=".*",a="[^\\t]*",o=new RegExp("^(".concat("\\d{2}-\\d{2}-\\d{4}",") (").concat("\\d{2}:\\d{2}:\\d{2}\\.\\d{3}",") (").concat("\\w+",")\t(").concat(n,")"));let r=t.match(o);if(!r)return console.error("Invalid log line format:",t),null;const[,s,E,i,l]=r,c=new RegExp("Log Version (".concat(n,")"));if(r=l.match(c),r){const[,t]=r;return console.log("Log Version ".concat(t)),{type:e.LOG_VERSION,date:s,time:E,timezone:i,logVersion:t}}const A=new RegExp("Logged in player is (".concat(n,")"));if(r=l.match(A),r){const[,t]=r;return{type:e.LOGGED_IN_PLAYER,date:s,time:E,timezone:i,loggedInPlayer:t}}const m=new RegExp("Boosted levels are \\[(\\d+), (\\d+), (\\d+), (\\d+), (\\d+), (\\d+), (\\d+)\\]");if(r=l.match(m),r){const[,t,n,a,o,l,c,A]=r.map(Number);return{type:e.BOOSTED_LEVELS,date:s,time:E,timezone:i,boostedLevels:{attack:t,strength:n,defence:a,ranged:o,magic:l,hitpoints:c,prayer:A}}}const p=new RegExp("Player equipment is (".concat(n,")"));if(r=l.match(p),r){const[,t]=r,n=JSON.parse(t).map((e=>e.toString()));return{type:e.PLAYER_EQUIPMENT,date:s,time:E,timezone:i,playerEquipment:n}}const g=new RegExp("^(".concat(n,") dies"));if(r=l.match(g),r){const[,t]=r;return{type:e.DEATH,date:s,time:E,timezone:i,target:t}}const M=new RegExp("^(".concat(n,") changes target to (").concat(n,")"));if(r=l.match(M),r){const[,t,n]=r;return{type:e.TARGET_CHANGE,date:s,time:E,timezone:i,source:t,target:n}}const _=new RegExp("^(".concat(a,")\t(").concat(a,")\t(").concat(a,")"));if(r=l.match(_),!r)return console.error("Invalid log line format:",t),null;const[,u,d,L]=r;return{type:e.DAMAGE,date:s,time:E,timezone:i,target:u,hitsplatName:d,damageAmount:parseInt(L,10)}};function E(t,n){try{const E=t.split("\n");let i=0,l=[];for(const e of E){const t=s(e.trim());if(t&&l.push(t),i++,n&&i%200===0){n(i/E.length*50)}}let c=function(t,n){const s=t.length;let E=0;const i=[];let l,c,A=null,m="",p=null;for(const g of t){if(g.type===e.LOGGED_IN_PLAYER&&(m=g.loggedInPlayer),g.type===e.BOOSTED_LEVELS&&(l=g.boostedLevels),g.type===e.PLAYER_EQUIPMENT&&(c=g.playerEquipment),A&&p&&a(g.time)-a(p.time)>6e4&&(A.data=A.data.filter(((e,t)=>t<=p.index)),A.name+=" - Incomplete",A.lastLine=A.data[A.data.length-1],i.push(A),A=null,p=null),!A&&g.type===e.DAMAGE&&r(g)&&g.target!==m){const t=[];l&&t.push({type:e.BOOSTED_LEVELS,date:g.date,time:g.time,timezone:g.timezone,boostedLevels:l}),c&&t.push({type:e.PLAYER_EQUIPMENT,date:g.date,time:g.time,timezone:g.timezone,playerEquipment:c}),A={name:g.target,enemies:[g.target],data:[...t,g],loggedInPlayer:m,firstLine:g,lastLine:void 0}}else A&&("target"in g&&o.includes(g.target)&&A.name!==g.target&&(A.name=g.target),g.type===e.DAMAGE&&r(g)&&g.target!==m&&!A.enemies.includes(g.target)&&A.enemies.push(g.target),A.data.push(g));A&&g.type===e.DAMAGE&&r(g)&&(p={time:g.time,index:A.data.length-1}),g.type===e.DEATH&&g.target&&(!A||g.target!==A.name&&g.target!==A.loggedInPlayer||(A.lastLine=g,i.push(A),A=null)),E++,n&&E%200===0&&n(50+E/s*50)}return A&&(A.lastLine=A.data[A.data.length-1],i.push(A)),i.filter((t=>t.data.some((t=>t.type===e.DAMAGE&&r(t)))))}(l,n);return c}catch(E){return console.error("Error parsing file content:",E),null}}let i=null;onmessage=e=>{const{type:t,fileContent:n,index:a}=e.data;if("parse"===t)!function(e){var t;i=E(e,(e=>{postMessage({type:"progress",progress:e})}));const n={fightNames:(null===(t=i)||void 0===t?void 0:t.map((e=>e.name)))||[],firstResult:i[0]};postMessage({type:"parseResult",parseResultMessage:n})}(n);else if("getItem"===t){const e=function(e){return i&&e>=0&&e<i.length?i[e]:null}(a);postMessage({type:"item",item:e})}}})();
//# sourceMappingURL=220.3d663f60.chunk.js.map