(()=>{"use strict";let e=function(e){return e[e.BLOCK_ME=12]="BLOCK_ME",e[e.DAMAGE_ME=16]="DAMAGE_ME",e[e.DAMAGE_ME_CYAN=18]="DAMAGE_ME_CYAN",e[e.DAMAGE_ME_ORANGE=20]="DAMAGE_ME_ORANGE",e[e.DAMAGE_ME_YELLOW=22]="DAMAGE_ME_YELLOW",e[e.DAMAGE_ME_WHITE=24]="DAMAGE_ME_WHITE",e[e.SPLASH_ME=69]="SPLASH_ME",e}({}),t=function(e){return e[e.DAMAGE_MAX_ME=43]="DAMAGE_MAX_ME",e[e.DAMAGE_MAX_ME_CYAN=44]="DAMAGE_MAX_ME_CYAN",e[e.DAMAGE_MAX_ME_ORANGE=45]="DAMAGE_MAX_ME_ORANGE",e[e.DAMAGE_MAX_ME_YELLOW=46]="DAMAGE_MAX_ME_YELLOW",e[e.DAMAGE_MAX_ME_WHITE=47]="DAMAGE_MAX_ME_WHITE",e}({});const n=e=>{const[t,n,a]=e.split(":").map(Number);return 36e5*t+6e4*n+1e3*a},a=["Scurrius","Kree'arra","Commander Zilyana","General Graardor","K'ril Tsutsaroth","Nex","Kalphite Queen","Sarachnis","Scorpia","Abyssal Sire"];function o(n){return Object.values(e).includes(n.hitsplatName)||Object.values(t).includes(n.hitsplatName)||"BLOCK_ME"===n.hitsplatName}const r=e=>{const t=".*",n="[^\\t]*",a=new RegExp("^(".concat("\\d{2}-\\d{2}-\\d{4}",") (").concat("\\d{2}:\\d{2}:\\d{2}\\.\\d{3}",") (").concat("\\w+",")\t(").concat(t,")"));let o=e.match(a);if(!o)return console.error("Invalid log line format:",e),null;const[,r,s,i,l]=o,c=new RegExp("Log Version (".concat(t,")"));if(o=l.match(c),o){const[,e]=o;return console.log("Log Version ".concat(e)),{date:r,time:s,timezone:i,logVersion:e}}const E=new RegExp("Logged in player is (".concat(t,")"));if(o=l.match(E),o){const[,e]=o;return{date:r,time:s,timezone:i,loggedInPlayer:e}}const m=new RegExp("Boosted levels are \\[(\\d+), (\\d+), (\\d+), (\\d+), (\\d+), (\\d+), (\\d+)\\]");if(o=l.match(m),o){const[,e,t,n,a,l,c,E]=o.map(Number);return{date:r,time:s,timezone:i,boostedLevels:{attack:e,strength:t,defence:n,ranged:a,magic:l,hitpoints:c,prayer:E}}}const A=new RegExp("Player equipment is (".concat(t,")"));if(o=l.match(A),o){const[,e]=o;return{date:r,time:s,timezone:i,playerEquipment:e}}const d=new RegExp("^(".concat(t,") dies"));if(o=l.match(d),o){const[,e]=o;return{date:r,time:s,timezone:i,target:e,hitsplatName:"DEATH"}}const g=new RegExp("^(".concat(t,") changes target to (").concat(t,")"));if(o=l.match(g),o){const[,e,t]=o;return{date:r,time:s,timezone:i,source:e,target:t,hitsplatName:"CHANGE_TARGET"}}const u=new RegExp("^(".concat(n,")\t(").concat(n,")\t(").concat(n,")"));if(o=l.match(u),!o)return console.error("Invalid log line format:",e),null;const[,M,_,p]=o;return{date:r,time:s,timezone:i,target:M,hitsplatName:_,damageAmount:parseInt(p,10)}};function s(e,t){try{const s=e.split("\n");let i=0,l=[];for(const e of s){const n=r(e.trim());if(n&&l.push(n),i++,t&&i%200===0){t(i/s.length*50)}}let c=function(e,t){const r=e.length;let s=0;const i=[];let l,c=null,E="",m=null;for(const A of e)A.loggedInPlayer&&(E=A.loggedInPlayer),A.boostedLevels&&(l=A.boostedLevels),c&&m&&n(A.time)-n(m.time)>6e4&&(c.data=c.data.filter(((e,t)=>t<=m.index)),c.name+=" - Incomplete",c.lastLine=c.data[c.data.length-1],i.push(c),c=null,m=null),!c&&o(A)&&A.target!==E?c={name:A.target,enemies:[A.target],data:[{date:A.date,time:A.time,timezone:A.timezone,boostedLevels:l},A],loggedInPlayer:E,firstLine:A,lastLine:void 0}:c&&(a.includes(A.target)&&c.name!==A.target&&(c.name=A.target),o(A)&&A.target!==E&&!c.enemies.includes(A.target)&&c.enemies.push(A.target),c.data.push(A)),c&&o(A)&&(m={time:A.time,index:c.data.length-1}),A.target&&"DEATH"===A.hitsplatName&&(!c||A.target!==c.name&&A.target!==c.loggedInPlayer||(c.lastLine=A,i.push(c),c=null)),s++,t&&s%200===0&&t(50+s/r*50);return c&&(c.lastLine=c.data[c.data.length-1],i.push(c)),i.filter((e=>e.data.some((e=>o(e)))))}(l,t);return c}catch(s){return console.error("Error parsing file content:",s),null}}let i=null;onmessage=e=>{const{type:t,fileContent:n,index:a}=e.data;if("parse"===t)!function(e){var t;i=s(e,(e=>{postMessage({type:"progress",progress:e})}));const n={fightNames:(null===(t=i)||void 0===t?void 0:t.map((e=>e.name)))||[],firstResult:i[0]};postMessage({type:"parseResult",parseResultMessage:n})}(n);else if("getItem"===t){const e=function(e){return i&&e>=0&&e<i.length?i[e]:null}(a);postMessage({type:"item",item:e})}}})();
//# sourceMappingURL=56.f3698249.chunk.js.map